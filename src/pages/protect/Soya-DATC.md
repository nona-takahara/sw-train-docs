# 宗弥急行プロジェクト デジタルATC

## 運転士インターフェース

## 保安装置設計（車上）

### 通信プロトコル

#### 型 Speed

|値|速度情報|
|:-|:---|
|0|無信号|
|1|非常停止 02|
|2|停止 01|
|3|入換 S25|
|4|入換 S40|
|5-7|予約|
|8-31|`(val - 5) * 5`|

#### 型 Gradient

|値|情報|
|:-|:---|
|0|下り35‰より大|
|1|下り35‰ - 下り25‰|
|2|下り25‰ - 下り15‰|
|3|下り15‰ - 下り5‰|
|4|下り5‰ - 上り5‰|
|5|上り5‰ - 上り15‰|
|6|上り15‰ - 上り25‰|
|7|上り25‰より大|

#### 型 Deceleration

|値|速度制限B 演算減速度|
|:-|:---|
|0|Bパターンなし|
|1|3.50 km/h/s|
|2|3.00 km/h/s|
|3|2.50 km/h/s|
|4|2.25 km/h/s|
|5|2.00 km/h/s|
|6|1.75 km/h/s|
|7|1.50 km/h/s|

#### 型 DiffSpeed

|値|速度制限B - 速度制限A|
|:-|:---|
|0|5 km/h|
|1|10 km/h|
|2|15 km/h|
|3|20 km/h|
|4|25 km/h|
|5|30 km/h|
|6|35 km/h|
|7|40 km/h|

#### H0 (簡易照査モード)
本保安装置は簡易照査に対応しない。

0 (float)

#### H1 (保安装置判別ID)
1 (float)

#### H2 (保安装置領域1: 停止信号照査)
30ビット整数値とfloat値の変換はTeinishiによる [Stormworks 数値信号に30ビット詰め込む話 - メモ置き場](https://teinishi.hateblo.jp/entry/stormworks-number-30bit) を採用する。

各距離は、信号連続性判別が正当である場合、信号区間始端からの距離となる。

|b29-b25|b24-b22|b21-b20|b19-b16|b15-b8|b7-b0|
|:------|:------|:------|:------|:-----|:----|
|信号区間最高速度(型 Speed)|勾配(型 Gradient)|信号連続性判別ID|信号連続性判別フラグ|停止点距離 / 10 (m)|信号区間長 / 10(m)|

#### H3 (保安装置領域2: 速度制限照査)
30ビット整数値とfloat値の変換はTeinishiによる [Stormworks 数値信号に30ビット詰め込む話 - メモ置き場](https://teinishi.hateblo.jp/entry/stormworks-number-30bit) を採用する。

各距離は、信号連続性判別が正当である場合、信号区間始端からの距離となる。

|b29-b25|b24-b22|b21-b19|b18-b16|b15-b8|b7-b0|
|:------|:------|:------|:------|:-----|:----|
|速度制限A 制限速度(型 Speed)|速度制限B 演算パターン減速度(型 Deceleration)|予備|速度制限B 速度差分(型 DiffSpeed)|速度制限A 始点距離 / 10 (m)|速度制限A 終点距離 / 10 (m)|

### 保安アルゴリズム

<!-- 上の各情報の図 -->
